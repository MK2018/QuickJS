var qk=new function(){var t,e,n;this.go=function(t){a.go(t)};var o=new function(){this.show=function(){this.style.display="block"},this.hide=function(){this.style.display="none"}},i=new function(){this["goto"]=function(e){t[n].hide(),n=a.pageById(e),t[n].show(),history.pushState(null,null,"#"+e)}},r=new function(){Object.prototype.watch||Object.defineProperty(Object.prototype,"watch",{enumerable:!1,configurable:!0,writable:!1,value:function(t,e){var n=this[t],o=n,i=function(){return o},r=function(i){return n=o,o=e.call(this,t,n,i)};delete this[t]&&Object.defineProperty(this,t,{get:i,set:r,enumerable:!0,configurable:!0})}}),Object.prototype.unwatch||Object.defineProperty(Object.prototype,"unwatch",{enumerable:!1,configurable:!0,writable:!1,value:function(t){var e=this[t];delete this[t],this[t]=e}});var t={};this.inputToBind=function(t){var e=t.getAttribute("qk-datato"),n=e.substring(0,e.lastIndexOf(".")),e=e.substring(e.lastIndexOf(".")+1);o(n,window)[e]=t.value},this.bind=function(t,e){var i=t.childNodes;void 0===e&&(e=t.getAttribute("qk-datafrom"));for(var r=0,a=i.length;a>r;r++)if("#text"===i[r].nodeName){var u=i[r].data,l=o(e,window),u=n(l,u,t);i[r].data=u}else this.bind(i[r],e)};var e=function(e,n,o,i){e.watch(String(n),function(e,n,o){return t[e].e.innerHTML=t[e].u,setTimeout(r.bind,0,t[e].e),o}),t[String(n)]={e:o,u:i}},n=function(t,i,r){for(var a="",u=i.split(""),l=!1,c=!1,s=!1,h="";0<u.length;)if(tok=u.shift(),"["===tok)l?(c=!0,l=!1):l=!0;else if("]"===tok)if(s){var s=c=!1,d=o(h.substring(h.indexOf("data.")+5),t);e(t,h.substring(h.indexOf("data.")+5),r,i),a+=d}else s=!0;else c?h+=tok:a+=tok;return-1<a.indexOf("[[")&&(a=n(t,a,r)),a},o=function(t,e){for(var n=t.split("."),o=e;0<n.length;)o=o[n.shift()];return o}},a=new function(){var u={},l=function(){Array.prototype.slice.call(document.querySelectorAll("a[qk-linkto]")).forEach(function(t){t.addEventListener("click",function(){i["goto"](t.getAttribute("qk-linkto"))})}),Array.prototype.slice.call(document.querySelectorAll("input[qk-datato]")).forEach(function(t){t.addEventListener("input",function(){r.inputToBind(t)})}),window.onhashchange=c},c=function(){if(""===window.location.hash||void 0===window.location.hash||"#"===window.location.hash){for(var e=n=a.pageById(u.home),o=0,i=t.length;i>o;o++)t[o].hide();t[e].show(),history.pushState(null,null,"#"+u.home)}else{for(e=n=a.pageById(window.location.hash.substring(1)),o=0,i=t.length;i>o;o++)t[o].hide();0>e?window.location.hash="#":t[e].show()}};this.pageById=function(e){for(var n=0,o=t.length;o>n;n++)if(t[n].getAttribute("qk-pageid")===e)return n;return-1},this.go=function(n){var i=Object.create(HTMLElement.prototype);i.show=o.show,i.hide=o.hide;var a=Object.create(HTMLElement.prototype);for(a.show=o.show,a.hide=o.hide,document.registerElement("qk-page",{prototype:i}),document.registerElement("qk-const",{prototype:a}),l(),t=document.querySelectorAll("qk-page[qk-pageid]"),e=document.querySelectorAll("[qk-datafrom]"),i=0,a=e.length;a>i;i++)r.bind(e[i]);u=n,c()}}};